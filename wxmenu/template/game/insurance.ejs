<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
<meta name="viewport" content="height=device-height,width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />

		<link href="http://piccvote.qiniudn.com/dist/css/vendor/bootstrap.min.css" rel="stylesheet">
		<link href="http://piccvote.qiniudn.com/base.css" rel="stylesheet">

		<script src="/static/winner_skin/phaser.min.js"></script>
		<script src="/static/winner_skin/Boot.js"></script>
		<script src="/static/winner_skin/Preloader.js"></script>
		<script src="/static/winner_skin/MainMenu.js"></script>
		<script src="/static/winner_skin/Game.js"></script>
		<style>
			body { margin: 0; padding:0;background-color: #000;}
			body{
				background-color:#ad0202 !important;
			}
			button{
				font-family: '微软雅黑'
			}
			.btn span{
				margin-right: 5px;
			}
			.modal_suc_box font {
				color: #c00;
				padding: 0 2px;
				line-height: 24px;
			}
			.startLicai{
				font-size: 17px;
				padding: 10px 20px;

			}
			.startLicai span{
				margin-right: 5px;
			}
			.rePlayBox{
				width: 100%;
				height: auto;
				border-top: #ccc 1px solid;
				padding: 10px 20px;
				text-align: right;
				position: relative;
			}
			.rePlayBtn{
				display: inline-block;
			}
			.jineinput{
				width: 70% !important;
			}
			.jineDanwei{
				padding-left: 10px;
				float: left;
				line-height: 30px;
			}
			.backSelectBox{
				padding: 0 20px 20px 20px;
				text-align: left;
			}
			.tableBox table td, .tableBox table th{
				text-align: center;
			}
			.loading_box{
				z-index: 9999;
			}
			.btn-toolbar{
				text-align: center;
			}
			.btn-toolbar a{
				display: block;
			}
			.btn-toolbar .btn{
				display: block;
				width: 200px;
				font-size: 16px;
				margin: 10px auto;
			}

			#selectBox .input-group-addon-left{
				width: 72px;
				display: block;
				text-align: left;
				font-weight: bolder;
			}
			.getBonusBox{
				padding: 10px;
				text-align: center;
			}
			select.form-control{
				border-radius: 0 !important;
				margin-left: -4px !important;
				text-indent: 1em;
			}
			.input-group-addon{
				position: relative;
				z-index: 10;
			}
			#qiangHb{
				background-color:#ccc !important;
				border-color:#ccc !important;
				margin-left: 15px;
			}
			.modal_suc_box{
				font-size: 15px;
				line-height: 30px;
				text-align: left;
			}
			.modal_suc_box span{
				font-family: "微软雅黑";
				text-indent: 2em;
				display: block;
			}
			.modal_suc_box font{
				font-size: 20px;
				padding: 0 2px;
			}
			h6.ft15{
				font-size:18px !important;
				color: #c00;
				font-weight: bold;
			}
			.table td, .table th{
				font-size: 13px;
			}
			#reSelectBtn{
				position: absolute;
				top: 10px;
				left: 20px;
			}
		</style>
	</head>
	<body>
		<script>
		(function() {
			// initialize the framework
			var game = new Phaser.Game(640, 960, Phaser.AUTO, 'game');
			// add game states
			game.state.add('Boot', Winner.Boot);
			game.state.add('Preloader', Winner.Preloader);
			game.state.add('MainMenu', Winner.MainMenu);
			game.state.add('Game', Winner.Game);
			// start the Boot state
			game.state.start('Boot');
		})();
		</script>



<!-- 投票成功 modal-->
<div class="modal " id="item_success_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close fui-cross" data-dismiss="modal" aria-hidden="true"></button>
        <h6 class="modal-title ft15" id="modalTitle">闯关成功</h6>
      </div>

      <div class="modal-body" id="successBox">
        	<div class="modal_suc_box ft16">
        		<span>亲，你已经抢到<font id="score_font"></font>万的金币，手气不错哟，快来理财吧！</span>
        		<span>您击败了全国<font id="rate_font"></font>的用户被封为<font id="title_font"></font></span></div>
        <div class="form-group getBonusBox">
        	<button id="startLicai" type="button" class="startLicai btn btn-danger btn-lg"><span class="glyphicon glyphicon-calendar"></span>开始理财</button>
        	<button id="qiangHb" type="button" class="startLicai btn btn-lg">抢红包</button>
        </div>
      </div>

      <div class="modal-body" id="selectBox" style="display:none">
        		<div class="form-group">
				    <div class="input-group">
				      <div class="input-group-addon"><span class="input-group-addon-left">投保金额</span></div>
				      <input id="cashInput" maxlength="5" max="99999" class="form-control jineinput" type="number" placeholder="投保金额1-1000（万元）">
				      <div class="jineDanwei">万元</div>
				    </div>
				</div>

				<div class="form-group">
				    <div class="input-group">
				      <div class="input-group-addon"><span class="input-group-addon-left">投保人性别</span></div>
				      <select class="form-control " id="sexSelect">
				      		<option value="1" selected="selected">男</option>
				      		<option value="2">女</option>
				      </select>
				    </div>
				</div>

				<div class="form-group">
				    <div class="input-group">
				      <div class="input-group-addon"><span class="input-group-addon-left">投保人年龄</span></div>
				      <select class="form-control " id="ageSelect">
		
				      </select>
				    </div>
				</div>
				
				<div class="form-group">
				    <div class="input-group">
				      <div class="input-group-addon"><span class="input-group-addon-left">缴费年限</span></div>
				      <select class="form-control" id="allocSelect">
				      		<option value="1" selected="selected">1:2 (缴费3年)</option>
				      		<option value="2">1:4 (缴费5年)</option>
				      		<option value="3">1:9 (缴费10年)</option>
				      </select>
				    </div>
				</div>
				<div class="form-group getBonusBox">
					<button id="getBonus" type="button" class="startLicai btn btn-danger btn-lg">查看收益</button>
				</div>

      </div>

      <div class="modal-body" id="showBonusBox" style="display:none">

        <div  class="tableBox" id="tableBox"></div>
        <div class="btn-toolbar" role="toolbar">
		  		<a href="" target="_blank"><button type="button" class="btn btn-success"><span class="glyphicon glyphicon-info-sign"></span>关于合众人寿</button></a>

		  		<a href="" target="_blank"><button type="button" class="btn btn-success"><span class="glyphicon glyphicon-warning-sign"></span>风险提示</button></a>

		  		<a href="" target="_blank"><button type="button" class="btn btn-success"><span class="glyphicon glyphicon-list"></span>产品说明</button></a>

		</div>
      </div>

      <div class="rePlayBox">
      		<button id="reSelectBtn" type="button" class="btn btn-info" style="display:none;">重选计划</button>
      		<button id="rePlayBtn" type="button" class="rePlayBtn btn btn-danger"><span class="glyphicon glyphicon-repeat"></span>再玩一次</button>
      </div>

    </div>
  </div>
</div>
<!-- 投票成功 modal-->



<!-- loading modal div -->
<div id="loading_box" class="loading_box" style="display:none"></div>
<!-- loading modal div -->


<!-- mask div -->
<div id="mask" class="mask_box" onclick="mask();"><img src="http://wzhfile.qiniudn.com/guide5.png"/></div> 
<!-- mask div -->


<script src="http://piccvote.qiniudn.com/dist/js/vendor/jquery.min.js" type="text/javascript"></script>
<script src="http://wzhfile.qiniudn.com/jquery.cookie.js"  type="text/javascript"></script>
<script src="http://wzzy2014skin.qiniudn.com/bootstrap/js/bootstrap.min.js"></script>
<script src="http://wzhfile.qiniudn.com/moment.js" type="text/javascript"></script>
<script src="http://piccvote.qiniudn.com/dist/js/flat-ui-pro.js"></script>
<script src="http://piccvote.qiniudn.com/assets/js/prettify.js"></script>
<script src="http://piccvote.qiniudn.com/assets/js/application.js"></script>

<script type="text/javascript">

//http://wx.mintok.com/active/unionlife?ename=unionlife_game
var forwardingUrl = 'http://wx.mintok.com/active/unionlife?ename=unionlife_game'
var forwardingImg = 'http://piccvote.qiniudn.com/unipay_logo2.png'
var forwardingTitle ='合众人寿十周年羊年活动'
var forwardingDesc ='合众人寿十周年羊年理财游戏活动'
var forwardingCallback = function(){
	$.cookie('gameIns', '1')

	if(window.clickReplay){
		setTimeout(function(){
			$('#successBox, #showBonusBox, #selectBox').hide()
			$('#item_success_modal').modal('hide')
			//restartGame()
			location.href = location.href
		}, 1000)
	}
}


var maskObj = $('#mask');
var mask = function () {		
		if(maskObj.is(':visible')){
			maskObj.hide();
		}
		else{
			maskObj.show();
		}
}
var loading_box = $('#loading_box')
	var loading = function(){
		loading_box.fadeIn(500)
	}
	var hideLoding = function(){
		loading_box.fadeOut(500)
	}


window.isAjax = false
var getBonusAjax = function(cash, sex, age, alloc){
	if(window.isAjax) return false;

	if(parseInt(cash) != cash){
		return alert('请输入正确的投保金额')
	}
	if(parseInt(sex) != sex){
		return alert('请输入选择正确的性别')
	}
	if(parseInt(age) != age){
		return alert('请输入正确的年龄')
	}
	if(parseInt(alloc) != alloc){
		return alert('请选择正确的资金分配')
	}
	loading()
	window.isAjax = true
	$.get('/insurance/unionlife/getbonus', {
		cash:cash,
		sex:sex,
		age:age,
		alloc:alloc
	}, function(d){
		window.isAjax = false
		hideLoding()
		if(d.error) return alert(d.data)
		putBonusData(d.data, age, alloc)

	},'json')
}

var genZeroTo60Option = function(){
	var temps = ''
	for(var i=0; i<61; i++){
		if(i==30){
			var selStr = 'selected="selected"'
		}
		else{
			var selStr = ''
		}
		temps += '<option value="'+i+'" '+selStr+'>'+i+' 岁</option>'
	}

	return temps
}

var tableStr ='<table class="table table-hover">'+
	      	  '<thead><tr>'+
	          '<th>年龄</th>'+
	          '<th>低红利</th>'+
	          '<th>中红利</th>'+
	          '<th>高红利</th></tr></thead>'+
      		  '<tbody>{content}</tbody></table>';
var putBonusData = function(bonusData, age, alloc){
	var age = parseInt(age)
	var tableBox = $('#tableBox')
	
	
	var checkList = [60, 70, 88]
    if(alloc == 1){
    	var jiaofei = 3
    }
    else if(alloc == 2){
    	var jiaofei = 5
    }
    else if(alloc == 3){
    	var jiaofei = 10
    }
    checkList = checkList.filter(function(v){
    	if(age+jiaofei+10 > v){
    		return false
    	}
    	return true
    })
    var tempStr = ''
    checkList.forEach(function(key){
    	tempStr += '<tr>'
    	tempStr += '<td>'+key.toString()+'岁</td>'
    	tempStr += '<td>'+(bonusData.lower[key.toString()]/10000).toFixed(2)+'万</td>'
    	tempStr += '<td>'+(bonusData.middle[key.toString()]/10000).toFixed(2)+'万</td>'
    	tempStr += '<td>'+(bonusData.high[key.toString()]/10000).toFixed(2)+'万</td>'
    	tempStr += '</tr>'
    })

    tableBox.html(tableStr.replace('{content}', tempStr))
    $('#successBox, #selectBox').hide()
	$('#showBonusBox').show()
}


var getResultInfo = function(score){
	if(score<= 50*10000){
		return [Math.floor(score/10000), '10%', '小财神']
	}
	else if(score<= 60*10000){
		return [Math.floor(score/10000), '20%', '小财神']
	}
	else if(score<= 70* 10000){
		return [Math.floor(score/10000), '30%', '小财神']
	}
	else if(score<= 80*10000){
		return [Math.floor(score/10000), '40%', '小财神']
	}
	else if(score<= 90*10000){
		return [Math.floor(score/10000), '50%', '小财神']
	}
	else if(score<= 100*10000){
		return [Math.floor(score/10000), '60%', '大财神']
	}
	else if(score<= 110*10000){
		return [Math.floor(score/10000), '70%', '大财神']
	}
	else if(score<= 120*10000){
		return [Math.floor(score/10000), '80%', '大财神']
	}
	else if(score<= 130*10000){
		return [Math.floor(score/10000), '90%', '大财神']
	}
	else if(score> 140*10000){
		return [Math.floor(score/10000), '99%', '大财神']
	}

}


var resultDiv = function(score){

	var fontRes = getResultInfo(score)

	$('#score_font').html(fontRes[0])
	$('#rate_font').html(fontRes[1])
	$('#title_font').html(fontRes[2])
	//保留两位小数
	$('#cashInput').val((score/10000).toFixed(2))
	$('#modalTitle').html('闯关成功')

	$('#selectBox, #showBonusBox').hide()
	$('#successBox').show()
	$('#item_success_modal').modal({
		'backdrop':'static'
	})
}


window.clickReplay = false

var bindClickEvent = function(){

	$('#startLicai').click(function(){
		$('#successBox, #showBonusBox').hide()
		$('#selectBox').show()
		$('#modalTitle').html('理财计划')
		return false;
	})

	$('#reSelectBtn').click(function(){
		$('#modalTitle').html('理财计划')
		$('#reSelectBtn').hide()
		$('#successBox, #showBonusBox').hide()
		$('#selectBox').show()
		return false;
	})


	$('#rePlayBtn').click(function(){

		window.clickReplay = true
		if($.cookie('gameIns') == '1'){
			location.href = location.href
		}
		else{
			mask()
		}
		return false;
	})
	
	$('#qiangHb').click(function(){
		alert('抢红包活动近期推出, 敬请期待…')
	})

	$('#getBonus').click(function(){
		var cash = ($('#cashInput').val() - 0)*10000
		var sex =$('#sexSelect').val()
		var age =$('#ageSelect').val()
		var alloc =$('#allocSelect').val()
		$('#modalTitle').html('收益计算结果')
		$('#reSelectBtn').show()
		getBonusAjax(cash, sex, age, alloc)

		return false;		
	})


	$('#allocSelect').change(function(){
		var v = $(this).val()
		if(v != 3){
			$('#ageSelect').find('option').show()
		}
		else{
			//10年交费只能55岁及以下
			var selAge = $('#ageSelect').val()
			$('#ageSelect').find('option').each(function(){
				var selfVal = $(this).val()				
				if(selAge>55 && selfVal == 55){
					alert('10年交费年龄不能超过55岁')
					$(this).attr('selected', 'selected')
				}
				if(selfVal >55){
					$(this).hide()
				}
			})					
		}
		

	})

	$('#ageSelect').html(genZeroTo60Option())

}()


function gameOverCallBack(score){

	resultDiv(score)
}


//resultDiv(300000)

</script>




<script src="http://wzhfile.qiniudn.com/wx_share_v3.js"></script> 
<div style="display:none">
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fd5dfbf4c48c3280b4cf4ca0f43407d09' type='text/javascript'%3E%3C/script%3E"));
</script>

</div>








	</body>
</html>